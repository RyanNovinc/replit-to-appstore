<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 2: Project Configuration | AI App to App Store</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0b;
            --bg-secondary: #111113;
            --bg-card: #18181b;
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            --accent: #22d3ee;
            --accent-glow: rgba(34, 211, 238, 0.15);
            --accent-hover: #06b6d4;
            --border: #27272a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Grotesk', -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 80px 20px;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            margin-bottom: 40px;
            transition: color 0.3s;
        }

        .back-link:hover {
            color: var(--accent);
        }

        h1 {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 16px;
            background: linear-gradient(135deg, var(--accent) 0%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 20px;
            color: var(--text-secondary);
            margin-bottom: 48px;
        }

        .module-meta {
            display: flex;
            gap: 16px;
            align-items: center;
            margin-bottom: 32px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .video-wrapper {
            max-width: 800px;
            margin: 0 0 48px 0;
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: var(--bg-card);
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 12px;
        }

        /* Step-by-Step Guide Section */
        .guide-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 48px;
            overflow: hidden;
        }

        .guide-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 20px 24px;
            cursor: pointer;
            user-select: none;
            transition: background 0.2s;
        }

        .guide-header:hover {
            background: rgba(34, 211, 238, 0.05);
        }

        .guide-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .guide-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            flex: 1;
        }

        .guide-arrow {
            color: var(--text-secondary);
            font-size: 12px;
            transition: transform 0.3s;
        }

        details[open] .guide-arrow {
            transform: rotate(180deg);
        }

        .guide-content {
            padding: 0 24px 24px 24px;
            border-top: 1px solid var(--border);
        }

        details[open] .guide-content {
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .guide-content h3 {
            color: var(--text-primary);
            margin: 24px 0 12px 0;
            font-size: 18px;
        }

        .guide-content p {
            color: var(--text-secondary);
            font-size: 15px;
            line-height: 1.7;
            margin-bottom: 16px;
        }

        .command-block {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            font-family: 'JetBrains Mono', monospace;
        }

        .command-block code {
            color: var(--accent);
            font-size: 14px;
            display: block;
        }

        .command-block .output {
            color: var(--text-muted);
            font-size: 13px;
            margin-top: 8px;
        }

        .info-box {
            background: rgba(34, 211, 238, 0.1);
            border: 1px solid rgba(34, 211, 238, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }

        .info-box-title {
            color: var(--accent);
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .info-box p {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
            margin: 0;
        }

        .error-box {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .error-box-title {
            color: #ef4444;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .error-box p {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
            margin: 0;
        }

        .checkpoint {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin: 24px 0;
        }

        .checkpoint-title {
            color: #10b981;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .checkpoint p {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
            margin: 0;
        }

        /* Screenshot Toggle - SMALLER IMAGE SIZE */
        .screenshot-toggle {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            margin: 24px 0;
            overflow: hidden;
            transition: all 0.2s;
        }

        .screenshot-toggle:hover {
            border-color: rgba(34, 211, 238, 0.3);
        }

        .screenshot-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            cursor: pointer;
            user-select: none;
            transition: background 0.2s;
        }

        .screenshot-header:hover {
            background: rgba(34, 211, 238, 0.05);
        }

        .screenshot-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .screenshot-label {
            font-size: 15px;
            font-weight: 600;
            color: var(--accent);
            flex: 1;
        }

        .screenshot-arrow {
            color: var(--text-secondary);
            font-size: 12px;
            transition: transform 0.3s;
        }

        details[open] .screenshot-arrow {
            transform: rotate(180deg);
        }

        .screenshot-content {
            padding: 0 20px 20px 20px;
            border-top: 1px solid var(--border);
        }

        details[open] .screenshot-content {
            animation: slideDown 0.3s ease-out;
        }

        /* SMALLER IMAGE - Not overwhelming! */
        .screenshot-img {
            max-width: 500px;
            width: 100%;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin: 16px auto 0 auto;
            cursor: pointer;
            transition: all 0.2s;
            display: block;
        }

        .screenshot-img:hover {
            border-color: var(--accent);
            box-shadow: 0 0 20px rgba(34, 211, 238, 0.2);
        }

        /* Lightbox - FIXED VERSION */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .lightbox.active { display: flex; }

        .lightbox-content {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .lightbox-image {
            max-width: 90%;
            max-height: 90vh;
            border-radius: 8px;
            box-shadow: 0 0 60px rgba(34, 211, 238, 0.3);
            cursor: zoom-in;
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            will-change: transform;
            user-select: none;
            touch-action: none;
        }

        .lightbox-image.zoomed { cursor: grab; }
        .lightbox-image.zoomed:active { cursor: grabbing; }
        .lightbox-image.dragging { transition: none !important; }

        .lightbox-close {
            position: fixed;
            top: 24px;
            right: 24px;
            width: 48px;
            height: 48px;
            background: var(--accent);
            border: none;
            border-radius: 50%;
            color: var(--bg-primary);
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            z-index: 10000;
        }

        .lightbox-close:hover {
            background: var(--accent-hover);
            transform: rotate(90deg);
        }

        .lightbox-hint {
            position: fixed;
            bottom: 32px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--text-muted);
            font-size: 14px;
            background: rgba(0, 0, 0, 0.7);
            padding: 12px 24px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        /* Course navigation module links */
        .module-nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.2s;
        }

        .module-nav-link:hover {
            border-color: var(--accent);
            transform: translateX(4px);
        }

        /* Navigation buttons */
        .nav-buttons {
            display: flex;
            gap: 16px;
            margin-top: 64px;
            padding-top: 32px;
            border-top: 1px solid var(--border);
        }

        .nav-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 16px 32px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 600;
            flex: 1;
        }

        .nav-btn:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .nav-btn.primary {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        .nav-btn.primary:hover {
            background: var(--accent-hover);
        }

        /* Mobile */
        @media (max-width: 768px) {
            .container {
                padding: 40px 20px;
            }

            h1 {
                font-size: 32px;
                text-align: center;
            }

            .subtitle {
                font-size: 16px;
                text-align: center;
            }

            .module-meta {
                justify-content: center;
                flex-wrap: wrap;
            }

            .guide-header {
                padding: 16px 20px;
            }

            .guide-content {
                padding: 0 20px 20px 20px;
            }

            .guide-title {
                font-size: 15px;
            }

            .nav-buttons {
                flex-direction: column;
                gap: 12px;
            }

            .nav-btn {
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
            }

            .lightbox-close {
                top: 16px;
                right: 16px;
                width: 44px;
                height: 44px;
            }

            .lightbox-hint {
                bottom: 20px;
                font-size: 12px;
                padding: 8px 16px;
            }

            /* Screenshot stays manageable on mobile */
            .screenshot-img {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="module-1.html" class="back-link">
            ‚Üê Back to Module 1
        </a>

        <h1>Module 2: Project Configuration</h1>
        <p class="subtitle">Set up your project files and configure settings for iOS deployment</p>
        
        <div class="module-meta">
            <span>‚è±Ô∏è 45 minutes</span>
            <span style="color: var(--text-muted);">‚Ä¢</span>
            <span>Module 2 of 3</span>
        </div>

        <!-- Module Video -->
        <div class="video-wrapper">
            <div class="video-container">
                <iframe 
                    src="https://www.youtube.com/embed/YOUR_VIDEO_ID_HERE"
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen>
                </iframe>
            </div>
        </div>

        <!-- Step-by-Step Guide (Collapsible) -->
        <details class="guide-section">
            <summary class="guide-header">
                <span class="guide-icon">üìã</span>
                <span class="guide-title">Step-by-Step Guide</span>
                <span class="guide-arrow">‚ñº</span>
            </summary>
            <div class="guide-content">
                <p>Now that your environment is set up, we'll configure your project to work with iOS. This involves installing dependencies, setting up configuration files, and preparing your app for native builds.</p>

                <h3>Step 1: Navigate to Your Project</h3>
                <p>Open your terminal and navigate to your project folder. If you exported from Replit or Lovable, unzip the file first:</p>
                
                <div class="command-block">
                    <code>cd path/to/your-app-folder</code>
                </div>

                <h3>Step 2: Install Dependencies</h3>
                <p>Install all required npm packages:</p>

                <div class="command-block">
                    <code>npm install</code>
                    <div class="output">‚úì This may take 2-5 minutes</div>
                </div>

                <p>If you see any warnings about peer dependencies, you can usually ignore them for now.</p>

                <h3>Step 3: Configure app.json</h3>
                <p>Open <code style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">app.json</code> in your code editor. Update these key fields:</p>

                <div class="command-block">
                    <code>{</code>
                    <code>  "expo": {</code>
                    <code>    "name": "YourAppName",</code>
                    <code>    "slug": "your-app-name",</code>
                    <code>    "version": "1.0.0",</code>
                    <code>    "ios": {</code>
                    <code>      "bundleIdentifier": "com.yourname.yourapp"</code>
                    <code>    }</code>
                    <code>  }</code>
                    <code>}</code>
                </div>

                <div class="info-box">
                    <div class="info-box-title">üí° Bundle Identifier Rules</div>
                    <p>Must be unique, lowercase, no spaces. Format: com.yourname.appname<br>Example: com.ryan.lifecompass</p>
                </div>

                <h3>Step 4: Run expo prebuild</h3>
                <p>This generates the native iOS and Android folders:</p>

                <div class="command-block">
                    <code>npx expo prebuild</code>
                    <div class="output">‚úì Creates ios/ and android/ folders</div>
                </div>

                <p>When prompted, answer:</p>
                <div class="command-block">
                    <code>? How would you like to proceed?</code>
                    <code>‚Ä∫ Generate new ios and android directories</code>
                </div>

                <h3>Step 5: Create eas.json</h3>
                <p>Initialize EAS (Expo Application Services):</p>

                <div class="command-block">
                    <code>eas build:configure</code>
                </div>

                <p>This creates an <code style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">eas.json</code> file. Open it and make sure it looks like this:</p>

                <div class="command-block">
                    <code>{</code>
                    <code>  "build": {</code>
                    <code>    "development": {</code>
                    <code>      "developmentClient": true,</code>
                    <code>      "distribution": "internal"</code>
                    <code>    },</code>
                    <code>    "preview": {</code>
                    <code>      "distribution": "internal"</code>
                    <code>    },</code>
                    <code>    "production": {</code>
                    <code>      "ios": {</code>
                    <code>        "buildConfiguration": "Release"</code>
                    <code>      }</code>
                    <code>    }</code>
                    <code>  }</code>
                    <code>}</code>
                </div>

                <h3>Step 6: Test Your Configuration</h3>
                <p>Start the development server to make sure everything works:</p>

                <div class="command-block">
                    <code>npx expo start</code>
                </div>

                <p>Scan the QR code with your phone's Expo Go app. Your app should load successfully.</p>

                <div class="checkpoint">
                    <div class="checkpoint-title">‚úÖ Checkpoint</div>
                    <p>Your project is now configured for iOS builds. You should have: app.json with bundle ID, eas.json created, and your app running in Expo Go.</p>
                </div>

                <h3 style="border-top: 1px solid var(--border); padding-top: 24px; margin-top: 32px;">‚ö†Ô∏è Common Issues</h3>

                <div class="error-box">
                    <div class="error-box-title">Error: "Invalid bundle identifier"</div>
                    <p><strong>Solution:</strong> Make sure your bundle ID is all lowercase with no spaces. Must follow format: com.yourname.appname</p>
                </div>

                <div class="error-box">
                    <div class="error-box-title">Error: "npm install" fails</div>
                    <p><strong>Solution:</strong> Delete node_modules folder and package-lock.json, then run npm install again. Make sure you have Node 18+.</p>
                </div>

                <div class="error-box">
                    <div class="error-box-title">Error: "expo prebuild" creates errors</div>
                    <p><strong>Solution:</strong> Make sure your app.json is valid JSON (no trailing commas, proper quotes). Run <code style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">npm install</code> first before running prebuild.</p>
                </div>


            

                <p>After installing, restart your terminal and run <code style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">node --version</code> again to verify.</p>

                <h3>Step 2: Install Expo CLI</h3>
                <p>Expo CLI lets you run Expo commands from your terminal. Install it globally:</p>

                <div class="command-block">
                    <code>npm install -g expo-cli</code>
                </div>

                <p>Verify the installation:</p>

                <div class="command-block">
                    <code>expo --version</code>
                    <div class="output">‚úì Expected output: 6.x.x or higher</div>
                </div>

                <h3>Step 3: Install EAS CLI</h3>
                <p>EAS CLI (Expo Application Services) is what creates production builds for the App Store:</p>

                <div class="command-block">
                    <code>npm install -g eas-cli</code>
                </div>

                <p>Verify:</p>

                <div class="command-block">
                    <code>eas --version</code>
                    <div class="output">‚úì Expected output: 5.x.x or higher</div>
                </div>

                <h3>Step 4: Create Expo Account</h3>
                <p>You'll need a free Expo account to build your app. Sign up at <a href="https://expo.dev/signup" target="_blank" style="color: var(--accent);">expo.dev/signup</a>, then log in from your terminal:</p>

                <div class="command-block">
                    <code>eas login</code>
                </div>

                <p>Enter your Expo username and password when prompted.</p>

                <h3>Step 5: Install VS Code (Optional but Recommended)</h3>
                <p>Download VS Code from <a href="https://code.visualstudio.com" target="_blank" style="color: var(--accent);">code.visualstudio.com</a>. This is the editor we'll use throughout the course, but you can use any code editor you prefer.</p>

                <h3>Step 6: Install Expo Go on Your Phone</h3>
                <p>Download the Expo Go app from the App Store (iOS) or Play Store (Android). You'll use this to test your app during development.</p>

                <div class="info-box">
                    <div class="info-box-title">üí° Tip for Mac Users</div>
                    <p>If you're on a Mac, you can also install Xcode Command Line Tools now (optional): <code style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">xcode-select --install</code></p>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-title">‚úÖ Verify Your Setup</div>
                    <p>Run these commands to confirm everything is installed correctly:</p>
                </div>

                <div class="command-block">
                    <code>node --version</code>
                    <code>npm --version</code>
                    <code>expo --version</code>
                    <code>eas --version</code>
                    <code>eas whoami</code>
                </div>

                <p>If all commands return version numbers (or your Expo username for the last one), you're ready to move on!</p>

                <h3 style="border-top: 1px solid var(--border); padding-top: 24px; margin-top: 32px;">‚ö†Ô∏è Common Issues</h3>

                <div class="error-box">
                    <div class="error-box-title">Error: "node" is not recognized</div>
                    <p><strong>Solution:</strong> Restart your terminal after installing Node.js. If that doesn't work, you may need to add Node.js to your system PATH manually. On Windows, try reinstalling Node.js and make sure "Add to PATH" is checked during installation.</p>
                </div>

                <div class="error-box">
                    <div class="error-box-title">Error: Permission denied (npm install)</div>
                    <p><strong>Solution on Mac/Linux:</strong> Try using sudo: <code style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">sudo npm install -g expo-cli</code></p>
                    <p><strong>Solution on Windows:</strong> Run your terminal as Administrator (right-click ‚Üí "Run as administrator")</p>
                </div>

                <div class="error-box">
                    <div class="error-box-title">Error: Command not found after installation</div>
                    <p><strong>Solution:</strong> Close your terminal completely and open a new one. The new commands need a fresh terminal session to be recognized.</p>
                </div>

            </div>
        </details>

        <!-- Course Navigation -->
        <div style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 32px; margin: 48px 0;">
            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 24px; color: var(--text-primary);">Course Modules</h3>
            
            <div style="display: flex; flex-direction: column; gap: 12px;">
                <a href="module-1.html" class="module-nav-link">
                    <span style="color: #10b981; font-size: 18px;">‚úì</span>
                    <span style="color: var(--text-muted); font-size: 15px;">Welcome & Overview</span>
                </a>
                
                <a href="module-1.html" class="module-nav-link">
                    <span style="color: #10b981; font-size: 18px;">‚úì</span>
                    <span style="color: var(--text-muted); font-size: 15px;">Module 1: Environment Setup</span>
                </a>
                
                <div style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(34, 211, 238, 0.1); border: 1px solid rgba(34, 211, 238, 0.3); border-radius: 8px;">
                    <span style="color: var(--accent); font-size: 18px;">‚Üí</span>
                    <span style="color: var(--accent); font-size: 15px; font-weight: 600;">Module 2: Project Configuration</span>
                </div>
                
                <a href="module-3.html" class="module-nav-link">
                    <span style="color: var(--text-muted); font-size: 18px;">‚óã</span>
                    <span style="color: var(--text-secondary); font-size: 15px;">Module 2: Project Configuration</span>
                </a>
                
                <a href="module-3.html" class="module-nav-link">
                    <span style="color: var(--text-muted); font-size: 18px;">‚óã</span>
                    <span style="color: var(--text-secondary); font-size: 15px;">Module 3: Apple Developer & Build</span>
                </a>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <a href="module-1.html" class="nav-btn">
                ‚Üê Previous: Environment Setup
            </a>
            <a href="module-3.html" class="nav-btn primary">
                Next: Apple Developer &amp; Build ‚Üí
            </a>
        </div>
    </div>

    <!-- Lightbox Modal -->
    <div class="lightbox" id="lightbox">
        <button class="lightbox-close" onclick="closeLightbox()">√ó</button>
        <div class="lightbox-content">
            <img src="" alt="" class="lightbox-image" id="lightboxImage">
        </div>
        <div class="lightbox-hint" id="lightboxHint"></div>
    </div>

    <script>
        // FIXED Lightbox - Smooth zoom & pan like native Photos
        const lightbox = document.getElementById('lightbox');
        const lightboxImage = document.getElementById('lightboxImage');
        const lightboxHint = document.getElementById('lightboxHint');
        
        let scale = 1;
        let translateX = 0;
        let translateY = 0;
        let isDragging = false;
        let startX, startY;

        // Detect mobile
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent) || 
                        ('ontouchstart' in window);

        // Set hint based on device
        lightboxHint.textContent = isMobile ? 
            'üì± Pinch to zoom ¬∑ Tap outside to close' : 
            'üñ±Ô∏è Scroll to zoom ¬∑ Drag to pan ¬∑ ESC to close';

        // Open lightbox
        document.querySelectorAll('.screenshot-img').forEach(img => {
            img.addEventListener('click', function() {
                lightboxImage.src = this.src;
                lightbox.classList.add('active');
                document.body.style.overflow = 'hidden';
                resetTransform();
            });
        });

        // Close lightbox
        function closeLightbox() {
            lightbox.classList.remove('active');
            document.body.style.overflow = '';
            resetTransform();
        }

        // Reset transform
        function resetTransform() {
            scale = 1;
            translateX = 0;
            translateY = 0;
            updateTransform(true);
        }

        // Update transform with smooth transition
        function updateTransform(smooth = true) {
            lightboxImage.classList.toggle('dragging', !smooth);
            lightboxImage.classList.toggle('zoomed', scale > 1);
            
            if (scale === 1) {
                translateX = 0;
                translateY = 0;
            }
            
            lightboxImage.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
        }

        // Close on background click
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox || e.target.classList.contains('lightbox-content')) {
                closeLightbox();
            }
        });

        // Close on ESC
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && lightbox.classList.contains('active')) {
                closeLightbox();
            }
        });

        // DESKTOP: Mouse wheel zoom
        if (!isMobile) {
            lightboxImage.addEventListener('wheel', (e) => {
                e.preventDefault();
                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                scale = Math.min(Math.max(1, scale * delta), 4);
                updateTransform(true);
            }, { passive: false });

            // DESKTOP: Mouse drag (only when zoomed)
            lightboxImage.addEventListener('mousedown', (e) => {
                if (scale > 1) {
                    e.preventDefault();
                    isDragging = true;
                    startX = e.clientX - translateX;
                    startY = e.clientY - translateY;
                }
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging && scale > 1) {
                    translateX = e.clientX - startX;
                    translateY = e.clientY - startY;
                    updateTransform(false);
                }
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
        }

        // MOBILE: Pinch zoom
        let initialDistance = 0;
        let initialScale = 1;

        lightboxImage.addEventListener('touchstart', (e) => {
            if (e.touches.length === 2) {
                e.preventDefault();
                initialDistance = getDistance(e.touches[0], e.touches[1]);
                initialScale = scale;
            } else if (e.touches.length === 1 && scale > 1) {
                isDragging = true;
                startX = e.touches[0].clientX - translateX;
                startY = e.touches[0].clientY - translateY;
            }
        }, { passive: false });

        lightboxImage.addEventListener('touchmove', (e) => {
            if (e.touches.length === 2) {
                e.preventDefault();
                const distance = getDistance(e.touches[0], e.touches[1]);
                scale = Math.min(Math.max(1, initialScale * (distance / initialDistance)), 4);
                updateTransform(false);
            } else if (e.touches.length === 1 && isDragging && scale > 1) {
                e.preventDefault();
                translateX = e.touches[0].clientX - startX;
                translateY = e.touches[0].clientY - startY;
                updateTransform(false);
            }
        }, { passive: false });

        lightboxImage.addEventListener('touchend', () => {
            isDragging = false;
            if (scale === 1) updateTransform(true);
        });

        // Helper function
        function getDistance(t1, t2) {
            const dx = t1.clientX - t2.clientX;
            const dy = t1.clientY - t2.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }

        // Prevent context menu
        lightboxImage.addEventListener('contextmenu', (e) => e.preventDefault());
    </script>
</body>
</html>
